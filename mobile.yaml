button_card_templates:
  personcard:
    tap_action:
      action: navigate
      navigation_path: |
        [[[
          return variables.navhash;
        ]]]  
    variables:
      battery_entity: null
      steps_entity: null
    custom_fields:
      steps: |
        [[[          
         let icon = states[variables.steps_entity].attributes?.icon;          
         return `<ha-icon icon="${icon}" style="width:10px;"></ha-icon> ${states[variables.steps_entity].state}`;
         ]]]
      battery: |
        [[[          
         let icon = states[variables.battery_entity].attributes?.icon;          
         return `<ha-icon icon="${icon}" style="width:10px;"></ha-icon> ${states[variables.battery_entity].state}%`;
         ]]]
    styles:
      custom_fields:
        steps:
          - font-size: 10px;
        battery:
          - font-size: 10px;
      name:
        - font-size: 10px
        - text-align: left
      card:
        - background: rgba(73, 185, 230,0.1);
        - border: 0
        - padding: 0
      grid:
        - grid-template-areas: '"i n n n" "battery battery steps steps"'
        - grid-template-columns: 1fr 1fr 1fr 1fr
        - grid-template-rows: 1fr 1fr
        - gap: 2px 2px
      i:
        - grid-area: 1 / 2 / 2 / 3
      'n':
        - grid-area: 1 / 3 / 2 / 4;
      battery:
        - grid-area: 1 / 3 / 2 / 4;
  settingscard:
    styles:
      card:
        - background: rgba(73, 185, 230,0.1);
        - border: 0
        - padding: 0
      grid:
        - grid-template-areas: '"rute lys enheter"'
        - grid-template-columns: 1fr 1fr 1fr
        - grid-template-rows: 1fr
        - gap: 2px 2px
      rute:
        - grid-area: 1 / 3 / 2 / 4;
    custom_fields:
      enheter:
        card:
          type: custom:button-card
          template: inlinecard
          show_state: false
          icon: mdi:devices
          name: Enheter
          tap_action:
            action: navigate
            navigation_path: '#enheter'
      rute:
        card:
          type: custom:button-card
          template: inlinecard
          show_state: false
          icon: mdi:timetable
          name: Rute
          entity: switch.schedule_0c6502
          tap_action:
            action: navigate
            navigation_path: '#rute'
      lys:
        card:
          type: custom:button-card
          template: inlinecard
          show_state: false
          icon: mdi:lightbulb
          name: |
            [[[              
              var entityIds = states['light.alle_lys']?.attributes?.entity_id;              
              var lightsOn = 0;
              for (var i = 0; i < entityIds.length; i++) {
                var lightState = states[entityIds[i]]?.state;
                if (lightState == 'on') { lightsOn++; }                                          
              }
              return `Lys (${lightsOn})`;
            ]]]
          entity: light.alle_lys
          tap_action:
            action: navigate
            navigation_path: '#all-lights'
  infocard:
    styles:
      card:
        - background: rgba(73, 185, 230,0.1);
        - border: 0
        - padding: 0
      grid:
        - grid-template-areas: '"morten naomi" '
        - grid-template-columns: 1fr 1fr
        - grid-template-rows: 1fr
        - gap: 2px 2px
      morten:
        - grid-area: 1 / 2 / 2 / 3
      naomi:
        - grid-area: 1 / 3 / 2 / 4;
      rute:
        - height: 100%
        - grid-area: 1 / 3 / 2 / 4;
    custom_fields:
      morten:
        card:
          type: custom:button-card
          template: personcard
          variables:
            battery_entity: sensor.pixel_8_pro_battery_level
            steps_entity: sensor.pixel_8_pro_daily_steps
            navhash: '#morten-card'
          show_state: false
          icon: mdi:dog
          name: Morten
          entity: person.morten
      naomi:
        card:
          type: custom:button-card
          template: personcard
          variables:
            battery_entity: sensor.pixel_7a_battery_level_2
            steps_entity: sensor.pixel_7a_daily_steps
            navhash: '#napol-card'
          icon: mdi:horse
          show_state: false
          name: Naomi
          entity: person.naomi
  ratescard:
    name: Import Rates
    tap_action:
      action: navigate
      navigation_path: /dashboard-solar
    styles:
      grid:
        - grid-template-areas: '"n n n" "rates rates rates"'
        - grid-template-columns: 1fr 1fr 1fr
        - grid-template-rows: 1fr
      card:
        - padding: 0
        - margin: 0
        - border: rgba(73, 185, 230,0.1);
        - background: rgba(73, 185, 230,0.1);
      name:
        - font-family: Roboto, sans-serif
        - letter-spacing: .1rem
        - justify-self: stretch
        - align-self: start
        - font-size: 12px
        - font-weight: 800
        - padding-bottom: 0
        - color: rgba(236, 236, 236,0.8)
        - text-shadow: 1px 1px 8px rgba(5,5,5,0.9)
      custom_fields:
        rates:
          - margin: 0
          - background: none
          - font-size: 0.5em
    custom_fields:
      rates: |
        [[[
          let test = states['binary_sensor.octopus_energy_target_nightly_lux_charge'];
          
          let element = states['event.octopus_energy_electricity_18p2053324_1414550002006_current_day_rates'];
          let elementTomorrow = states['event.octopus_energy_electricity_18p2053324_1414550002006_next_day_rates'];
          let maxRate = element.attributes.max_rate;
          let minRate = element.attributes.min_rate;

          let output = "<table>";
          let graph = "<div style=\"width:100%; background-color:none\">";
          element.attributes.rates.forEach((elem) => {

            let dateParsed = new Date(Date.parse(elem.start)); 

            if (dateParsed > new Date()) {
              let dateParsedStr = dateParsed.getHours() + ":" + String(dateParsed.getMinutes()).padStart(2,"0");            
              let startDate = dateParsed.toLocaleTimeString().slice(0,-3);
              let rateValue = parseFloat(elem.value_inc_vat*100).toFixed(2);
              let ratePerc = ((elem.value_inc_vat / maxRate)*95);
              if (ratePerc < 10) { ratePerc = 50; }
              let startColor = 'rgba(40,50,80,0.9)';
              let endColor = 'rgb(1,100,1)';
              if (rateValue > 20) { endColor = 'rgb(100,100,1)'; } 
              if (rateValue > 30) { endColor = 'rgb(200,50,1)'; } 
              let rowColor = `linear-gradient(to right,${startColor} 1%,${endColor} 50%, ${endColor})`
              graph = graph + `<div style='padding-left:2px;padding-right:5px;background:${rowColor};text-align:left; width:${ratePerc}%;'>
              <span style='text-align:left'>${dateParsedStr}</span><span style='float:right;'>${rateValue}p</span>
              </div>`;
              output = output + `<tr><td>${startDate}</td><td>${rateValue}</td><td>${ratePerc}</td></tr>`;
            }
          });
          graph = graph + "</div>";
          output = output + "</table>";


          return `<div>${graph}</div>`;

        ]]]
  mediacard:
    variables:
      entity_id: media_player.soverom_hoyttaler
    styles:
      grid:
        - grid-template-areas: '"i n n" "player player player"'
        - grid-template-columns: 1fr 1fr 1fr
        - grid-template-rows: 1fr
    custom_fields:
      player:
        card:
          type: custom:mini-media-player
          entity: |
            [[[
              return variables.entity_id;
            ]]]
          artwork: cover-fit
          group: false
          shortcuts:
            columns: 4
            buttons:
              - type: script
                id: script.mass_media_play
                data:
                  media_player_entity_id: |
                    [[[ return variables.entity_id; ]]]                      
                  media_id: https://lyd.nrk.no/icecast/mp3/high/s0w7hwn47m/p1
                name: P1
              - type: script
                id: script.mass_media_play
                data:
                  media_player_entity_id: |
                    [[[ return variables.entity_id; ]]]                      
                  media_id: https://lyd.nrk.no/icecast/mp3/high/s0w7hwn47m/p1pluss
                name: P1+
              - type: script
                id: script.mass_media_play
                data:
                  media_player_entity_id: |
                    [[[ return variables.entity_id; ]]]                      
                  media_id: https://lyd.nrk.no/icecast/mp3/high/s0w7hwn47m/p2
                name: P2
              - type: script
                id: script.mass_media_play
                data:
                  media_player_entity_id: |
                    [[[ return variables.entity_id; ]]]                      
                  media_id: https://lyd.nrk.no/icecast/mp3/high/s0w7hwn47m/klassisk
                name: Klassisk
              - type: script
                id: script.mass_media_play
                data:
                  media_player_entity_id: |
                    [[[ return variables.entity_id; ]]]                      
                  media_id: https://lyd.nrk.no/icecast/mp3/high/s0w7hwn47m/folkemusikk
                name: NRK Folk
              - type: script
                id: script.mass_media_play
                data:
                  media_player_entity_id: |
                    [[[ return variables.entity_id; ]]]                      
                  media_id: https://lyd.nrk.no/icecast/mp3/high/s0w7hwn47m/jazz
                name: NRK Jazz
              - type: script
                id: script.mass_media_play
                data:
                  media_player_entity_id: |
                    [[[ return variables.entity_id; ]]]                      
                  media_id: BBC Radio 4
                name: Radio 4
  barscard:
    variables:
      min: 0
      max: 100
      startcolour: blue
      endcolour: rgba(20,20,20,0.3)
    styles:
      state:
        - text-align: left
        - width: 100%
        - font-size: 11px
        - font-weight: bold
      name:
        - text-align: left
        - font-size: 11px
        - width: 100%
      card:
        - height: 100%;
        - border: 1px solid;
        - background-size: 100% 20px, 100%;
        - border-color: |
            [[[ 
            return variables.startcolour; ]]]
        - background: |
            [[[              
              var perc = parseInt((entity.state / variables.max) * 100);
              if (isNaN(perc)) { perc = 0; }

              var grad = `linear-gradient(to right, ${variables.startcolour} 0%, ${variables.startcolour}, ${variables.startcolour} ${perc}%, ${variables.endcolour}, ${variables.endcolour} 100%)`;              
              return grad;
            ]]]
      grid:
        - grid-template-areas: '"i n n" "i s s"'
        - grid-template-columns: 1fr 1fr 1fr
        - grid-template-rows: 1fr
  inlinecard:
    styles:
      state:
        - text-align: left
        - width: 100%
        - font-size: 11px
        - font-weight: bold
      name:
        - text-align: left
        - font-size: 11px
        - width: 100%
      card:
        - height: 100%;
        - background: rgba(20,20,20,0.3);
      grid:
        - grid-template-areas: '"i n n" "i s s"'
        - grid-template-columns: 1fr 1fr 1fr
        - grid-template-rows: 1fr
  solarcard:
    show_state: true
    styles:
      card:
        - background: rgba(156,104,0,0.1);
        - border: 0
        - padding: 0
      grid:
        - grid-template-areas: '"solar"  "consumption" "battery" "statustext"'
        - grid-template-columns: 1fr
        - grid-template-rows: 1fr 1fr 1fr 1fr
        - gap: 2px 2px
      solar:
        - grid-area: 1 / 2 / 2 / 3
      battery:
        - grid-area: 1 / 3 / 2 / 4;
      consumption:
        - grid-area: 1 / 3 / 2 / 4;
    custom_fields:
      solar:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          icon: mdi:sun-wireless
          name: Solar
          entity: sensor.lux_solar_output_live
          variables:
            max: 5000
            startcolour: rgba(156,174,0,0.7)
            endcolour: rgba(255,255,255,0)
      battery:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          name: Battery
          entity: sensor.lux_battery
          variables:
            startcolour: rgba(0,104,0,1)
      consumption:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          icon: mdi:home-import-outline
          name: Consumption
          entity: sensor.lux_home_consumption_live
          variables:
            max: 5000
            startcolour: rgba(150,100,0,0.7)
            endcolour: rgba(255,255,255,0)
      statustext:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          name: Grid flow
          entity: sensor.lux_grid_flow_live
          variables:
            min: -4000
            max: 4000
            startcolour: rgba(50,200,50,0.7)
            endcolour: rgba(100,0,0,0.0)
  aqicard:
    show_state: true
    styles:
      card:
        - background: rgba(73, 185, 230,0.5);
        - border: 0
        - padding: 0
      grid:
        - grid-template-areas: '"score c02 tvoc pm25"'
        - grid-template-columns: 1fr 1fr 1fr 1fr
        - grid-template-rows: 1fr
        - gap: 2px 2px
      solar:
        - grid-area: 1 / 2 / 2 / 3
      battery:
        - grid-area: 1 / 3 / 2 / 4;
      consumption:
        - grid-area: 1 / 3 / 2 / 4;
    custom_fields:
      score:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          icon: mdi:percent
          name: Air
          entity: sensor.awair_lr_score
          variables:
            startcolour: rgba(73, 185, 230,0.5)
      c02:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          name: CO2
          entity: sensor.awair_lr_co2
          variables:
            min: 400
            max: 1200
            startcolour: rgba(252, 186, 3,0.2)
      tvoc:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          name: VOC
          entity: sensor.awair_lr_voc
          variables:
            min: 500
            max: 10000
            startcolour: rgba(252, 69, 3,0.5)
      pm25:
        card:
          type: custom:button-card
          template: barscard
          show_state: true
          name: PM 2.5
          entity: sensor.awair_lr_pm25
          variables:
            min: 0
            max: 200
            startcolour: rgba(211, 5, 247,0.5)
  roomcardnav:
    icon: |
      [[[
        return variables.icon;
      ]]]
    tap_action:
      action: navigate
      navigation_path: |
        [[[
          return variables.navhash;
        ]]]
    variables:
      onoff: ''
      navhash: ''
      icon: ''
    size: 100%
    styles:
      icon:
        - transform: scale(0.4)
        - font-size: 2px !important;
        - color: >
            [[[ if (states[variables.onoff]?.state == 'on') { return
            'rgba(30,30,30,0.95)'; }
              else { return 'rgba(20,20,20,0.5)'; }
            ]]]                     
      card:
        - border-radius: 20px
        - filter: drop-shadow(0 0 1.0rem rgb(243,156,15))
        - font-size: 10px
        - background: >
            [[[ if (states[variables.onoff]?.state == 'on' || variables.onoff ==
            'on') { return 'rgba(200,200,22,0.5)'; }
              else { return 'rgba(20,20,20,0.2)'; }
            ]]]
  roomcard2:
    group_expand: true
    tap_action:
      action: navigate
      navigation_path: |
        [[[
          return variables.room_hash;
        ]]]
    custom_fields:
      btn1:
        card:
          type: custom:button-card
          triggers_update: |
            [[[ return variables.btn1_onoff; ]]]
          template: roomcardnav
          variables:
            onoff: |
              [[[ return variables.btn1_onoff; ]]]
            navhash: |
              [[[ return variables.btn1_hash; ]]]
            icon: |
              [[[ return variables.btn1_icon; ]]]
      btn2:
        card:
          type: custom:button-card
          triggers_update: |
            [[[ return variables.btn2_onoff; ]]]          
          template: roomcardnav
          variables:
            onoff: |
              [[[ return variables.btn2_onoff; ]]]          
            navhash: |
              [[[ return variables.btn2_hash; ]]]
            icon: |
              [[[ return variables.btn2_icon; ]]]                              
      infospan: |
        [[[
          let content = '';
          let tText = `${states[variables.temperature_entity].state}`;          
          if (tText == 'unavailable') { tText = ''; }
          let tColor = 'rgba(200,200,180,0.5)';
          if (Number(tText) < 15) { tColor = 'rgba(100,200,255,0.8)'; }
          if (Number(tText) > 18) { tColor = 'rgba(255,200,100,0.8)'; }
          if (Number(tText) > 20) { tColor = 'rgba(255,100,100,0.9)'; }


          content = content + `<span style="color: ${tColor}"><ha-icon icon="mdi:thermometer" style="width: 12px; height: 12px;"></ha-icon>${tText}</span>`;

          
          let fText = `${states[variables.humidity_entity].state}`;          
          if (fText == 'unavailable') { fText = ''; }
          let fColor = 'rgba(200,200,180,0.5)';          
          if (Number(fText) > 70) { fColor = 'rgba(100,200,255,0.9)'; }
          if (Number(fText) > 80) { fColor = 'rgba(0,0,255,1.0)'; }
                  
          
          content = content + `<br/><span style="color:${fColor}"><ha-icon icon="mdi:water-percent" style="width: 12px; height: 12px;"></ha-icon>${fText}</span>`
          let text = "";
          if (variables.media_entity) {
            console.log("media entity", states[variables.media_entity]);
            if (states[variables.media_entity].attributes && states[variables.media_entity].attributes?.media_title) {
              text = states[variables.media_entity].attributes?.media_title;
              content = content + `<br/><div style="font-size: 0.8em;"><marquee behavior=scroll scrollamount=1>${text}</marquee></div>`;
            }
          }
          
          return content;
        ]]]
      blank: |
        [[[
          return '';
        ]]]
    variables:
      temperature_entity: null
      humidity_entity: null
      motion_entity: null
      media_entity: null
      btn1_hash: null
      btn1_onoff: null
      btn2_hash: null
      btn2_onoff: null
      room_hash: ''
      other: |
        [[[ return ""; ]]]
    styles:
      custom_fields:
        other:
          - padding: 20px
          - border: 0 !important
        infospan:
          - font-size: 0.8em
          - display: flex
          - flex-direction: column
          - align-items: center
          - justify-content: space-around
          - height: 90%
        tspan:
          - font-size: 0.8em
          - height: 100%
          - display: flex
          - align-items: center
          - justify-content: center
          - width: 100%
          - text-align: center
          - background: none
          - color: rgba(200,200,200,0.8);
          - text-shadow: 1px 1px 1px rgba(5,5,5,0.4)
        btn1:
          - height: 100%
          - display: flex
          - align-items: center
          - justify-content: center
        btn2:
          - height: 100%
          - display: flex
          - align-items: center
          - justify-content: center
      grid:
        - grid-template-areas: >-
            "n n n" "infospan infospan btn1" "infospan infospan btn2" "i blank
            btn2"
        - grid-template-columns: 0.8fr 1fr 0.8fr
        - grid-template-rows: 0.8fr 0.5fr 0.5fr 0.8fr
        - border-radius: 20px
        - margin: 5px
        - padding-right: 5px
        - box-shadow: |
            [[[
              function convertRange(value,r1,r2) { return (value-r1[0])*(r2[1]-r2[0])/(r1[1]-r1[0])+r2[0];}                                                                    
              let output = "4.0px 8.0px 8.0px hsl(0deg 0% 0% / 0.78);"              
              let output2 = `4px 4px 2px 3px  hsl(0deg 0% 0% / 0.38), 3px 3px 8px 3px  ${variables.roomcolor.slice(0, -2)}0.5)`;              
              return output2;
              if (!variables.temperature_entity) { return output; }
               let tVal = states[variables.temperature_entity]?.state;                                
              let tValScaled = convertRange(tVal,[15,30],[120,0]);
              //output = `4.0px 8.0px 8.0px hsla(${tValScaled},20%,20%,0.38)`;                                          

              return output2;  
            ]]]
        - background: |
            [[[
              function convertRange(value,r1,r2) { return (value-r1[0])*(r2[1]-r2[0])/(r1[1]-r1[0])+r2[0];}

              let tempEntity = states[variables.temperature_entity];                                          
              let tVal = tempEntity.state;                                
              
              if (tVal == 'unavailable') { tVal = 0; }

              let humidEntity = states[variables.humidity_entity];              
              let hVal = humidEntity.state;           
              if (hVal == 'unavailable') { hVal = 0; }
              let tValScaled = convertRange(tVal,[15,30],[100,0]);
              let tempHsla = `hsla(${tValScaled},50%,50%,0.5)`;                                      
              let hValScaled = convertRange(hVal,[50,100],[130,235])              
              let fuktHsla = `hsla(${hValScaled},10%,50%,0.5)`;

              let roomHsla = tempHsla;
              if (variables.roomcolor) {
                roomHsla = variables.roomcolor;
              }

              let output3 = `                      
              radial-gradient(at top left, ${roomHsla} 0%, transparent 50%),
              radial-gradient(at top right, ${roomHsla} 0%, transparent 50%),
              radial-gradient(at bottom right, ${roomHsla} 0%, transparent 50%),                                                    
              radial-gradient(at bottom left, ${roomHsla} 20%,${tempHsla} 30%, ${fuktHsla} 35%, transparent 60%),
              linear-gradient(0deg, transparent 0%, ${roomHsla} 50%, transparent 100%)
              `;

              return output3;
            ]]]        
      name:
        - font-family: Roboto, sans-serif
        - letter-spacing: .1rem
        - justify-self: stretch
        - align-self: start
        - font-size: 20px
        - font-weight: 800
        - padding-top: 0.5em
        - padding-bottom: 0
        - margin-bottom: 0
        - color: |
            [[[
              let defaultcolor = 'rgba(236, 236, 236,0.8)';

              let transform = `${variables.roomcolor.slice(0, -2)}0.9)`;
              console.log("trans",transform);
              return defaultcolor;
            ]]]
        - text-shadow: |
            [[[
              let transform = `${variables.roomcolor.slice(0, -2)}0.9)`;

              let tshadow = `1px 1px 3px ${transform}`;
              return tshadow;

            ]]]
      state:
        - display: none
      img_cell:
        - justify-content: start
        - position: absolute
        - width: 50px;
        - height: 50px;
        - left: 0
        - bottom: 0
        - margin: 0 0 15px 15px
        - border-radius: 500px
      icon:
        - width: 40px
        - color: |
            [[[
              if (variables.motion_entity && states[variables.motion_entity]?.state == 'on') {                
                return "rgba(255,149,1,0.9)";                                    
              }
              return "rgba(255,255,255,0.9)";
            ]]]
        - opacity: '0.6'
      card:
        - background: none
        - border-width: 0px
        - min-height: 50px
  roomcard_nocontrols:
    template: roomcard2
    styles:
      grid:
        - grid-template-areas: '"n n n" "infospan infospan infospan" "i blank blank"'
        - grid-template-columns: 1fr 0.5fr 1fr
        - grid-template-rows: 1fr 1fr 1fr
      card:
        - min-height: 50px
      name:
        - font-size: 15px
        - font-weight: 800
        - padding-bottom: 0.5em
decluttering_templates:
  spisestue-media:
    card:
      type: vertical-stack
      cards:
        - type: custom:button-card
          template: mediacard
          variables:
            entity_id: media_player.spisestue_nest_hub
  spisestue-lys:
    card:
      type: vertical-stack
      cards:
        - type: custom:mushroom-light-card
          entity: light.spisestue_lampe_light
          show_brightness_control: true
          layout: horizontal
          show_color_control: false
          name: Lampe
          icon: mdi:lamp
        - type: custom:mushroom-light-card
          entity: light.spisestue_sterjnelys
          show_brightness_control: true
          layout: horizontal
          show_color_control: true
          name: Sterjnelys
          icon: mdi:star-circle
  stue-media:
    card:
      type: vertical-stack
      cards:
        - type: media-control
          entity: media_player.living_room_tv_2
        - type: custom:button-card
          template: mediacard
          variables:
            entity_id: media_player.piano_nest_hub
  stue-lys:
    card:
      type: vertical-stack
      cards:
        - type: horizontal-stack
          cards:
            - type: custom:mushroom-light-card
              entity: light.stue_stikkontakt
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
              name: Stue Lampe
              icon: mdi:lamp
            - type: custom:mushroom-light-card
              entity: light.juletree_lys_switch
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
              icon: mdi:bookshelf
        - type: custom:mushroom-light-card
          entity: light.lekelys_light
          show_brightness_control: true
          layout: horizontal
          fill_container: true
          use_light_color: true
          show_color_control: true
          icon: mdi:bookshelf
        - type: custom:mushroom-light-card
          entity: light.stue_godstol_lys
          show_brightness_control: true
          layout: horizontal
          fill_container: true
          use_light_color: true
          show_color_control: true
          icon: mdi:bookshelf
  al-media:
    card:
      type: custom:button-card
      template: mediacard
      variables:
        entity_id: media_player.beberom_hoyttaler
  al-kamera:
    card:
      type: custom:webrtc-camera
      url: rtsp://homeass:homeass@192.168.1.166:554/stream1
      ui: false
      muted: false
      digital_ptz:
        mouse_drag_pan: true
        mouse_wheel_zoom: true
        mouse_double_click_zoom: true
        touch_drag_pan: true
        touch_pinch_zoom: true
        touch_tap_drag_zoom: true
        persist: true
  soverom-lys:
    card:
      type: vertical-stack
      cards:
        - type: custom:mushroom-light-card
          entity: light.senglys_light
          show_brightness_control: true
          layout: horizontal
          show_color_control: false
        - type: grid
          columns: 2
          square: false
          cards:
            - type: custom:mushroom-light-card
              name: Venstre
              entity: light.soveromlys_venstre
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
            - type: custom:mushroom-light-card
              entity: light.soveromlys_hoyre
              name: Høyre
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
        - type: custom:mushroom-light-card
          entity: light.soverom_speil_2_light
          show_brightness_control: true
          layout: horizontal
          show_color_control: false
          name: Speil
        - type: custom:mushroom-light-card
          entity: light.soverom_lys_tak_1_light
          show_brightness_control: true
          layout: horizontal
          show_color_control: false
          name: Tak
  soverom-media:
    card:
      type: vertical-stack
      cards:
        - type: custom:button-card
          template: mediacard
          variables:
            entity_id: media_player.soverom_hoyttaler_2
  all-lights-card:
    card:
      type: vertical-stack
      cards:
        - type: custom:auto-entities
          card:
            type: entities
          filter:
            include:
              - group: light.alle_lys
                options:
                  secondary_info: last-changed
          sort:
            method: name
            reverse: false
  morten-card:
    card:
      type: vertical-stack
      cards:
        - type: entities
          entities:
            - entity: person.morten
            - entity: sensor.steam_76561197960958444
            - entity: sensor.pixel_8_pro_battery_level
            - entity: sensor.pixel_8_pro_daily_steps
            - entity: sensor.steps
            - entity: sensor.sleep_start_time
            - entity: sensor.sleep_time_in_bed
            - entity: sensor.sleep_minutes_asleep
            - entity: sensor.sleep_minutes_awake
            - entity: sensor.sleep_efficiency
  napol-card:
    card:
      type: vertical-stack
      cards:
        - type: entities
          entities:
            - entity: person.naomi
            - entity: sensor.pixel_7a_battery_level_2
            - entity: sensor.pixel_7a_daily_steps
  kontor-enheter:
    card:
      type: vertical-stack
      cards:
        - type: conditional
          conditions:
            - condition: user
              users:
                - 03908e65b4514ba48ac9f9946bb5ca8d
          card:
            type: entities
            entities:
              - entity: binary_sensor.kontor_bevegelsessensor_ias_sone
              - entity: switch.spisestue_skjoteledning_b
              - entity: switch.spisestue_skjoteledning_c
              - entity: switch.kontor_sentral_skjerm
              - entity: button.grace_grace_rgb_off
              - entity: button.grace_grace_rgb_grey
              - entity: button.grace_grace_mediaplaypause
              - entity: sensor.database_free_space_days_remaining
              - entity: sensor.database_size_growth_daily_last_period
        - show_name: true
          show_icon: true
          type: button
          tap_action:
            action: navigate
            navigation_path: /config/zha/add
          entity: update.zha_network_card_update
          icon: mdi:zigbee
        - type: entities
          entities:
            - sensor.grace_gputemperature
            - sensor.grace_storage_d
            - sensor.grace_storage_c
  kontor-lys:
    card:
      type: vertical-stack
      cards:
        - type: grid
          columns: 2
          square: false
          cards:
            - type: custom:mushroom-light-card
              entity: light.zone_light_1
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
              name: Light 1
            - type: custom:mushroom-light-card
              entity: light.zone_light_2
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
              name: Light 2
        - type: grid
          columns: 2
          square: false
          cards:
            - type: custom:mushroom-light-card
              entity: light.kontorlys_venstre
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
              name: Venstre
            - type: custom:mushroom-light-card
              entity: light.kontorlys_hoyre
              show_brightness_control: true
              layout: horizontal
              show_color_control: false
              name: Høyre
        - type: custom:mushroom-light-card
          entity: light.kontor_magic
          show_brightness_control: true
          layout: horizontal
          show_color_control: false
        - type: entities
          entities:
            - input_select.kontor_mode
  kjokken-media:
    card:
      type: vertical-stack
      cards:
        - type: custom:button-card
          template: mediacard
          variables:
            entity_id: media_player.kjokken_hoyttaler_2
  kjokken-enheter:
    default:
      - icon: fire
    card:
      type: vertical-stack
      cards:
        - type: history-graph
          entities:
            - entity: sensor.kjoleskap_temperatur
        - type: grid
          columns: 1
          square: false
          cards:
            - type: entities
              entities:
                - entity: sensor.sm_n960f_battery_level
                - entity: switch.juletree_switch
                - entity: sensor.kjoleskap_temperatur
views:
  - path: roomcardnew
    background: >-
      radial-gradient(rgba(57,24,1,0.67) 0%, rgba(206,133,251,0) 100%),
      linear-gradient(45deg, transparent 0%, rgba(38,87,0,0.61) 100%,
      rgba(127,176,6,0.51) 100%), linear-gradient(rgba(0,2,140,0.69) 0%,
      rgba(47,78,94,0.62) 100%), linear-gradient(154deg, rgba(9,133,204,1) 0%,
      rgba(59,78,240,1) 100%)
    cards:
      - type: custom:button-card
        template: infocard
      - type: custom:button-card
        template: settingscard
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            template: roomcard2
            variables:
              temperature_entity: sensor.zone_temperatur
              humidity_entity: sensor.zone_fuktighet
              motion_entity: binary_sensor.kontor_bevegelsessensor_occupancy
              name: Kontor
              roomcolor: hsla(17, 50%, 50%, 1)
              btn1_hash: '#kontor-lys'
              btn1_icon: mdi:lamp
              btn1_onoff: light.kontor_magic
              btn2_hash: '#kontor-enheter'
              btn2_icon: mdi:devices
              btn2_onoff: switch.spisestue_skjoteledning_b
              room_hash: '#kontor-room'
            name: Kontor
            icon: mdi:chair-rolling
          - type: custom:button-card
            template: roomcard2
            variables:
              temperature_entity: sensor.kjoekken_temperatur
              humidity_entity: sensor.kjoekken_fuktighet
              motion_entity: binary_sensor.kjoekken_bevegelsessensor_occupancy
              media_entity: media_player.kjokken_hoyttaler
              name: Kjøkken
              roomcolor: hsla(138, 10%, 50%, 1)
              btn1_hash: '#kjokken-media'
              btn1_icon: mdi:speaker
              btn1_onoff: media_player.kjokken_hoyttaler
              btn2_hash: '#kjokken-enheter'
              btn2_icon: mdi:devices
              room_hash: '#kjokken-room'
            name: Kjøkken
            icon: mdi:microwave
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            template: roomcard2
            group_expand: true
            name: Soverom
            icon: mdi:bed
            variables:
              temperature_entity: sensor.soverom_temperatur
              humidity_entity: sensor.soverom_fuktighet
              name: Soverom
              roomcolor: hsla(238, 50%, 50%, 1)
              btn1_hash: '#soverom-lys'
              btn1_icon: mdi:lamp
              btn1_onoff: light.soverom_lys
              btn2_hash: '#soverom-media'
              btn2_icon: mdi:speaker
              room_hash: '#soverom-room'
          - type: custom:button-card
            template: roomcard2
            variables:
              temperature_entity: sensor.kontor_temperatur
              humidity_entity: sensor.kontor_fuktighet
              roomcolor: hsla(299, 50%, 50%, 1)
              btn1_hash: '#al-kamera'
              btn1_onoff: 'on'
              btn1_icon: mdi:video
              btn2_hash: '#al-media'
              btn2_icon: mdi:speaker
              room_hash: '#al-room'
            name: Anna-Lisbeth
            icon: mdi:elephant
            entity: sensor.kontor_temperatur
        columns: 2
      - type: grid
        square: false
        columns: 1
        cards:
          - type: custom:button-card
            template: aqicard
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            template: roomcard2
            variables:
              temperature_entity: sensor.awair_lr_temp
              humidity_entity: sensor.awair_lr_humid
              name: Stue
              roomcolor: hsla(104, 100%, 27%, 1)
              room_hash: '#stue-room'
              btn1_hash: '#stue-lys'
              btn1_icon: mdi:lamp
              btn1_onoff: light.stue_lys
              btn2_hash: '#stue-media'
              btn2_icon: mdi:speaker
            name: Stue
            icon: mdi:sofa
          - type: custom:button-card
            template: roomcard2
            variables:
              temperature_entity: sensor.gjallarhorn_temperature
              humidity_entity: sensor.gjallarhorn_humidity
              motion_entity: binary_sensor.spisestue_any
              roomcolor: hsla(260, 100%, 57%, 1)
              room_hash: '#spisestue-room'
              btn1_hash: '#spisestue-lys'
              btn1_icon: mdi:lamp
              btn1_onoff: light.spisestue_lys
              btn2_hash: '#spisestue-media'
              btn2_icon: mdi:speaker
            name: Spisestue
            icon: mdi:star
            tap_action:
              action: navigate
              navigation_path: '#spisestue-room'
            show_state: true
        columns: 2
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#kjokken-room'
            name: Kjøkken
            icon: mdi:table-chair
            button_type: state
            show_state: true
            show_last_changed: false
            show_attribute: false
            card_layout: large
            entity: sensor.kjoekken_temperatur
          - type: custom:decluttering-card
            template: kjokken-media
          - type: custom:decluttering-card
            template: kjokken-enheter
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#kjokken-media'
            name: Kjokken Media
            icon: mdi:speaker
            button_type: state
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
            entity: media_player.kjokken_hoyttaler
          - type: custom:decluttering-card
            template: kjokken-media
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#kjokken-enheter'
            name: Kjøkken Enheter
            icon: mdi:table-chair
            button_type: state
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: kjokken-enheter
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#kontor-lys'
            name: Kontor
            icon: mdi:chair-rolling
            entity: light.kontor_magic
            button_type: slider
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: kontor-lys
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#kontor-enheter'
            name: Kontor Enheter
            icon: mdi:chair-rolling
            button_type: state
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: kontor-enheter
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#morten-card'
            name: Morten
            entity: person.morten
            icon: mdi:dog
            button_type: state
            show_state: false
          - type: custom:decluttering-card
            template: morten-card
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#all-lights'
            name: Lys
            entity: light.alle_lys
            icon: mdi:light-flood-up
            button_type: state
            show_state: false
          - type: custom:decluttering-card
            template: all-lights-card
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#napol-card'
            name: Naomi
            entity: person.naomi
            icon: mdi:horse
            button_type: state
            show_state: false
          - type: custom:decluttering-card
            template: napol-card
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#kontor-room'
            name: Kontor
            icon: mdi:chair-rolling
            button_type: state
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: kontor-lys
          - type: custom:decluttering-card
            template: kontor-enheter
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#soverom-media'
            name: Soverom Media
            icon: mdi:speaker
            button_type: state
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: soverom-media
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#soverom-lys'
            name: Soverom Lys
            icon: mdi:bed
            entity: light.soverom_lys
            button_type: slider
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: soverom-lys
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#soverom-room'
            name: Soverom
            icon: mdi:bed
            entity: light.soverom_lys
            button_type: slider
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: soverom-media
          - type: custom:decluttering-card
            template: soverom-lys
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#al-kamera'
            name: AL Kamera
            icon: mdi:chair-rolling
            button_type: state
            show_state: false
            show_header: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: al-kamera
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#al-media'
            name: AL Media
            icon: mdi:speaker
            button_type: state
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
            entity: media_player.beberom_hoyttaler
          - type: custom:decluttering-card
            template: al-media
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#al-room'
            name: Anna-Lisbeth
            icon: mdi:elephant
            button_type: name
            show_state: false
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: vertical-stack
            cards:
              - type: custom:decluttering-card
                template: al-media
              - type: custom:decluttering-card
                template: al-kamera
              - square: false
                type: grid
                cards:
                  - type: custom:mushroom-light-card
                    entity: light.beberom_lys_light
                    name: Seng
                    show_color_temp_control: false
                    use_light_color: true
                    show_brightness_control: true
                    layout: horizontal
                  - type: custom:mushroom-light-card
                    entity: light.brodboks_stikkontakt_switch
                    name: Lese lys
                columns: 2
              - type: custom:comfortable-environment-card
                room_name: Anna-Lisbeth
                temperature_sensor: sensor.kontor_temperatur
                humidity_sensor: sensor.kontor_fuktighet
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#stue-media'
            name: Stue Media
            icon: mdi:sofa
            entity: media_player.living_room_tv_2
            button_type: name
            show_state: true
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: stue-media
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#stue-lys'
            name: Stue Lys
            icon: mdi:sofa
            entity: light.stue_lys
            button_type: name
            show_state: true
            show_last_changed: true
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: stue-lys
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#stue-room'
            name: Stue
            icon: mdi:sofa
            entity: sensor.awair_lr_temp
            button_type: state
            show_state: true
            show_last_changed: false
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: stue-lys
          - type: custom:decluttering-card
            template: stue-media
          - type: custom:mushroom-chips-card
            chips:
              - type: entity
                entity: sensor.awair_lr_score
                icon_color: primary
              - type: entity
                entity: sensor.awair_lr_pm25
                icon: mdi:molecule
                icon_color: red
              - type: entity
                entity: sensor.awair_lr_voc
                icon: mdi:air-filter
                icon_color: teal
              - type: entity
                entity: sensor.awair_lr_co2
                icon: mdi:molecule-co2
                icon_color: amber
            alignment: justify
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#spisestue-lys'
            name: Spisestue
            icon: mdi:desk
            button_type: state
            show_state: true
            show_last_changed: false
            show_attribute: false
            card_layout: large
          - type: custom:decluttering-card
            template: spisestue-lys
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#spisestue-media'
            name: Spisestue
            icon: mdi:desk
            card_layout: large
          - type: custom:decluttering-card
            template: spisestue-media
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#spisestue-room'
            name: Spisestue
            icon: mdi:desk
            card_layout: large
          - type: custom:decluttering-card
            template: spisestue-lys
          - type: custom:decluttering-card
            template: spisestue-media
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#garasje-room'
            name: Garasje
            icon: mdi:weight-lifter
            card_layout: large
          - type: custom:webrtc-camera
            url: rtsp://homeass:homeass@192.168.1.46:554/stream2
            ui: false
            muted: false
            digital_ptz:
              mouse_drag_pan: true
              mouse_wheel_zoom: true
              mouse_double_click_zoom: true
              touch_drag_pan: true
              touch_pinch_zoom: true
              touch_tap_drag_zoom: true
              persist: true
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            show_header: false
            hash: '#rute'
          - type: custom:scheduler-card
            include:
              - automation
              - binary_sensor
              - button
              - calendar
              - climate
              - cover
              - device_tracker
              - group
              - input_number
              - input_select
              - light
              - media_player
              - notify
              - number
              - person
              - scene
              - script
              - select
              - sensor
              - sun
              - switch
              - vacuum
            exclude: []
            title: ''
            time_step: 30
            display_options:
              primary_info: default
              secondary_info:
                - relative-time
                - additional-tasks
              icon: action
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#verksted-room'
            name: Verksted
            icon: mdi:hand-saw
            card_layout: large
          - type: custom:webrtc-camera
            url: rtsp://homeass:homeass@192.168.1.47:554/stream1
            ui: false
            muted: false
            digital_ptz:
              mouse_drag_pan: true
              mouse_wheel_zoom: true
              mouse_double_click_zoom: true
              touch_drag_pan: true
              touch_pinch_zoom: true
              touch_tap_drag_zoom: true
              persist: true
          - type: entities
            entities:
              - light.verksted_lys
              - sensor.verksted_fuktighet
              - sensor.verksted_temperatur
      - type: vertical-stack
        cards:
          - type: custom:bubble-card
            card_type: pop-up
            hash: '#enheter'
            name: Enheter
            icon: mdi:devices
            card_layout: large
          - type: entities
            entities:
              - switch.dehumidifier_switch
          - type: custom:auto-entities
            view_layout:
              grid-area: main
            card:
              show_header_toggle: false
              title: Offline
              type: entities
            filter:
              include:
                - domain: sensor
                  integration: zha
                  entity_id: '*_batteri'
                  state: unavailable
                - domain: sensor
                  integration: zha
                  entity_id: '*_batteri'
                  state: unknown
                - domain: sensor
                  integration: zha
                  entity_id: '*_power'
                  state: unavailable
                - domain: sensor
                  integration: zha
                  entity_id: '*_power'
                  state: unknown
            show_empty: false
          - type: custom:auto-entities
            card:
              type: entities
              state_color: true
            filter:
              include:
                - entity_id: binary_sensor.*ias_*
                  options:
                    secondary_info: last-changed
                - entity_id: binary_sensor.*occupancy
                  options:
                    secondary_info: last-changed
                - entity_id: binary_sensor.*beveg*
                  options:
                    secondary_info: last-changed
              exclude:
                - domain: binary_sensor
                  state: unknown
                - domain: binary_sensor
                  state: unavailable
            sort:
              method: last_changed
              reverse: true
            unique: true
      - square: false
        columns: 3
        type: grid
        cards:
          - type: custom:button-card
            template: roomcard_nocontrols
            variables:
              temperature_entity: sensor.garasje_temperatur
              humidity_entity: sensor.garasje_fuktighet
              name: Garasje
              roomcolor: hsla(231, 51%, 26%, 1)
              room_hash: '#garasje-room'
            name: Garasje
            icon: mdi:weight-lifter
          - type: custom:button-card
            template: roomcard_nocontrols
            variables:
              temperature_entity: sensor.verksted_temperatur
              humidity_entity: sensor.verksted_fuktighet
              motion_entity: binary_sensor.dorsensor_status
              roomcolor: hsla(100, 51%, 26%, 1)
              room_hash: '#verksted-room'
            name: Verksted
            icon: mdi:hand-saw
          - type: custom:button-card
            template: roomcard_nocontrols
            variables:
              temperature_entity: sensor.baderom_temperatur
              humidity_entity: sensor.baderom_fuktighet
              roomcolor: hsla(189, 66%, 52%, 1)
            name: Baderom
            icon: mdi:shower-head
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            template: ratescard
          - type: custom:button-card
            template: solarcard
    type: custom:vertical-layout
